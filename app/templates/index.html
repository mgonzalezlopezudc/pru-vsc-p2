{% extends "base.html" %}

{% block title %}{{ t('index.title') }}{% endblock %}

{% block content %}
<section class="hero card">
  <p class="eyebrow">{{ t('index.eyebrow') }}</p>
  <h2>{{ t('index.heading') }}</h2>
  <p class="meta">{{ t('index.meta') }}</p>
</section>

<section class="section-head">
  <h3>{{ t('index.stores') }}</h3>
</section>
<section class="card form-block">
  <h4>{{ t('form.store_create') }}</h4>
  <form method="post" action="{{ url_for('main.create_store', lang=current_lang) }}" class="inline-form">
    {{ store_create_form.hidden_tag() }}
    <label>{{ t('field.name') }}<input type="text" name="{{ store_create_form.name.name }}" required maxlength="120"></label>
    <label>{{ t('field.address') }}<input type="text" name="{{ store_create_form.address.name }}" required maxlength="240"></label>
    <label>{{ t('field.image') }}<input type="url" name="{{ store_create_form.image.name }}" required maxlength="400"></label>
    <label>{{ t('field.latitude') }}<input type="number" step="any" name="{{ store_create_form.latitude.name }}" required></label>
    <label>{{ t('field.longitude') }}<input type="number" step="any" name="{{ store_create_form.longitude.name }}" required></label>
    <button type="submit" class="btn">{{ t('action.create') }}</button>
  </form>
</section>
<section class="cards-grid cards-grid-stores">
  {% for store in stores %}
  <article class="media-card">
    <a class="media-thumb" href="{{ url_for('main.store_detail', store_id=store.id) }}">
      <img src="{{ store.image }}" alt="{{ store.name }}" loading="lazy" data-fallback="{{ url_for('static', filename='images/store-placeholder.svg') }}" onerror="this.onerror=null;this.src=this.dataset.fallback;">
    </a>
    <div class="media-body">
      <a class="media-title" href="{{ url_for('main.store_detail', store_id=store.id) }}">{{ store.name }}</a>
      <p class="meta">{{ store.address }}</p>
      <form method="post" class="compact-form" action="{{ url_for('main.delete_store', store_id=store.id, lang=current_lang) }}">
        {{ delete_form.hidden_tag() }}
        <button type="submit" class="btn btn-danger">{{ t('action.delete') }}</button>
      </form>
    </div>
  </article>
  {% endfor %}
</section>

<section class="section-head">
  <h3>{{ t('index.products') }}</h3>
</section>
<section class="card form-block">
  <h4>{{ t('form.product_create') }}</h4>
  <form method="post" action="{{ url_for('main.create_product', lang=current_lang) }}" class="inline-form">
    {{ product_create_form.hidden_tag() }}
    <label>{{ t('field.name') }}<input type="text" name="{{ product_create_form.name.name }}" required maxlength="120"></label>
    <label>{{ t('field.size') }}<input type="text" name="{{ product_create_form.size.name }}" required maxlength="24"></label>
    <label>{{ t('field.price') }}<input type="number" name="{{ product_create_form.price.name }}" min="0" required></label>
    <label>{{ t('field.image') }}<input type="url" name="{{ product_create_form.image.name }}" required maxlength="400"></label>
    <button type="submit" class="btn">{{ t('action.create') }}</button>
  </form>
</section>
<section class="cards-grid cards-grid-products">
  {% for product in products %}
  <article class="media-card product-card">
    <a class="media-thumb square" href="{{ url_for('main.product_detail', product_id=product.id) }}">
      <img src="{{ product.image }}" alt="{{ product.name }}" loading="lazy" data-fallback="{{ url_for('static', filename='images/product-placeholder.svg') }}" onerror="this.onerror=null;this.src=this.dataset.fallback;">
    </a>
    <div class="media-body">
      <a class="media-title" href="{{ url_for('main.product_detail', product_id=product.id) }}">{{ product.name }}</a>
      <p class="meta">{{ product.size }} Â· {{ product.price|currency }}</p>
      <form method="post" class="compact-form" action="{{ url_for('main.delete_product', product_id=product.id, lang=current_lang) }}">
        {{ delete_form.hidden_tag() }}
        <button type="submit" class="btn btn-danger">{{ t('action.delete') }}</button>
      </form>
    </div>
  </article>
  {% endfor %}
</section>
{% endblock %}
