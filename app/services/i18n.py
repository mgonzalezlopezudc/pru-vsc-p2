DEFAULT_LANGUAGE = "es"
SUPPORTED_LANGUAGES = ("es", "en")

LANGUAGE_LABELS = {
    "es": "ES",
    "en": "EN",
}

TRANSLATIONS = {
    "es": {
        "app.title": "Retail Viewer",
        "app.header": "Retail Data Viewer",
        "nav.home": "Inicio",
        "nav.inventory": "Inventario global",
        "lang.label": "Idioma",
        "warnings.title": "Validaciones",
        "index.title": "Inicio | Retail Viewer",
        "index.eyebrow": "Retail intelligence",
        "index.heading": "Explora tiendas y productos con una vista clara del inventario",
        "index.meta": "Dataset de prueba con 4 tiendas, 16 baldas y 10 productos enlazados.",
        "index.stores": "Tiendas",
        "index.stores_map": "Mapa de tiendas",
        "index.products": "Productos",
        "store.title": "{name} | Tienda",
        "store.eyebrow": "Tienda",
        "store.location": "Ubicación",
        "store.shelves": "Baldas",
        "store.shelves_3d": "Vista 3D de baldas",
        "store.shelves_3d_hint": "Recorre la tienda en primera persona con estanterías físicas y productos colocados por balda.",
        "store.shelves_3d_empty": "No hay baldas disponibles para mostrar en 3D.",
        "store.shelves_3d_empty_products": "Sin productos asignados.",
        "store.shelves_3d_start": "Iniciar recorrido inmersivo",
        "store.shelves_3d_help_label": "Mostrar ayuda de navegación",
        "store.shelves_3d_exit": "Pulsa ESC para salir del modo inmersivo",
        "store.shelves_3d_controls": "Mover: flechas del cursor · Correr: Shift",
        "store.shelves_3d_pointer": "Mirar: mover ratón · Salir: ESC",
        "store.inventory": "Inventario de la tienda",
        "product.title": "{name} | Producto",
        "product.eyebrow": "Producto",
        "product.size": "Tamaño",
        "product.price": "Precio",
        "product.availability": "Disponibilidad por tienda",
        "inventory.title": "Inventario global | Retail Viewer",
        "inventory.heading": "Inventario global",
        "table.name": "Nombre",
        "table.current_load": "Carga actual",
        "table.max_capacity": "Capacidad máxima",
        "table.store": "Tienda",
        "table.shelf": "Balda",
        "table.product": "Producto",
        "table.price": "Precio",
        "table.stock_total": "Stock total",
        "table.on_shelf": "En balda",
        "table.actions": "Acciones",
        "action.create": "Crear",
        "action.edit": "Editar",
        "action.save": "Guardar",
        "action.delete": "Eliminar",
        "action.delete_store": "Eliminar tienda",
        "action.delete_product": "Eliminar producto",
        "action.view_store": "Ver tienda",
        "action.cancel": "Cancelar",
        "form.shelf_create": "Crear balda",
        "form.shelf_edit": "Editar balda: {name}",
        "form.inventory_create": "Crear ítem de inventario",
        "form.inventory_edit": "Editar ítem de inventario",
        "form.store_create": "Crear tienda",
        "form.store_edit": "Editar tienda",
        "form.product_create": "Crear producto",
        "form.product_edit": "Editar producto",
        "field.name": "Nombre",
        "field.address": "Dirección",
        "field.image": "URL imagen",
        "field.latitude": "Latitud",
        "field.longitude": "Longitud",
        "field.price": "Precio (céntimos)",
        "field.size": "Tamaño",
        "field.max_capacity": "Capacidad máxima",
        "field.stock_count": "Stock total",
        "field.shelf_count": "En balda",
        "field.store_id": "Tienda",
        "field.shelf_id": "Balda",
        "field.product_id": "Producto",
        "placeholder.select_shelf": "Selecciona una balda",
        "error.required": "Campo obligatorio.",
        "error.length": "Longitud inválida.",
        "error.non_negative": "Debe ser un valor no negativo.",
        "error.shelf_le_stock": "En balda no puede superar el stock total.",
        "error.invalid_store_ref": "Referencia de tienda no válida.",
        "error.invalid_shelf_ref": "Referencia de balda no válida para la tienda seleccionada.",
        "error.invalid_product_ref": "Referencia de producto no válida.",
        "error.invalid_coordinate": "{field} no es válido.",
        "flash.shelf_created": "Balda creada.",
        "flash.shelf_updated": "Balda actualizada.",
        "flash.shelf_deleted": "Balda eliminada.",
        "flash.inventory_created": "Ítem de inventario creado.",
        "flash.inventory_updated": "Ítem de inventario actualizado.",
        "flash.inventory_deleted": "Ítem de inventario eliminado.",
        "flash.store_created": "Tienda creada.",
        "flash.store_updated": "Tienda actualizada.",
        "flash.store_deleted": "Tienda eliminada.",
        "flash.product_created": "Producto creado.",
        "flash.product_updated": "Producto actualizado.",
        "flash.product_deleted": "Producto eliminado.",
    },
    "en": {
        "app.title": "Retail Viewer",
        "app.header": "Retail Data Viewer",
        "nav.home": "Home",
        "nav.inventory": "Global inventory",
        "lang.label": "Language",
        "warnings.title": "Validations",
        "index.title": "Home | Retail Viewer",
        "index.eyebrow": "Retail intelligence",
        "index.heading": "Explore stores and products with a clear inventory view",
        "index.meta": "Test dataset with 4 stores, 16 shelves, and 10 linked products.",
        "index.stores": "Stores",
        "index.stores_map": "Store map",
        "index.products": "Products",
        "store.title": "{name} | Store",
        "store.eyebrow": "Store",
        "store.location": "Location",
        "store.shelves": "Shelves",
        "store.shelves_3d": "3D shelf view",
        "store.shelves_3d_hint": "Walk through the store in first person with physical shelf units and shelf-based product placement.",
        "store.shelves_3d_empty": "No shelves available to render in 3D.",
        "store.shelves_3d_empty_products": "No products assigned.",
        "store.shelves_3d_start": "Start immersive walkthrough",
        "store.shelves_3d_help_label": "Show navigation help",
        "store.shelves_3d_exit": "Press ESC to exit immersive mode",
        "store.shelves_3d_controls": "Move: arrow keys · Sprint: Shift",
        "store.shelves_3d_pointer": "Look: move mouse · Exit: ESC",
        "store.inventory": "Store inventory",
        "product.title": "{name} | Product",
        "product.eyebrow": "Product",
        "product.size": "Size",
        "product.price": "Price",
        "product.availability": "Availability by store",
        "inventory.title": "Global inventory | Retail Viewer",
        "inventory.heading": "Global inventory",
        "table.name": "Name",
        "table.current_load": "Current load",
        "table.max_capacity": "Maximum capacity",
        "table.store": "Store",
        "table.shelf": "Shelf",
        "table.product": "Product",
        "table.price": "Price",
        "table.stock_total": "Total stock",
        "table.on_shelf": "On shelf",
        "table.actions": "Actions",
        "action.create": "Create",
        "action.edit": "Edit",
        "action.save": "Save",
        "action.delete": "Delete",
        "action.delete_store": "Delete store",
        "action.delete_product": "Delete product",
        "action.view_store": "View store",
        "action.cancel": "Cancel",
        "form.shelf_create": "Create shelf",
        "form.shelf_edit": "Edit shelf: {name}",
        "form.inventory_create": "Create inventory item",
        "form.inventory_edit": "Edit inventory item",
        "form.store_create": "Create store",
        "form.store_edit": "Edit store",
        "form.product_create": "Create product",
        "form.product_edit": "Edit product",
        "field.name": "Name",
        "field.address": "Address",
        "field.image": "Image URL",
        "field.latitude": "Latitude",
        "field.longitude": "Longitude",
        "field.price": "Price (cents)",
        "field.size": "Size",
        "field.max_capacity": "Maximum capacity",
        "field.stock_count": "Total stock",
        "field.shelf_count": "On shelf",
        "field.store_id": "Store",
        "field.shelf_id": "Shelf",
        "field.product_id": "Product",
        "placeholder.select_shelf": "Select a shelf",
        "error.required": "This field is required.",
        "error.length": "Invalid length.",
        "error.non_negative": "Must be a non-negative value.",
        "error.shelf_le_stock": "On-shelf amount cannot exceed total stock.",
        "error.invalid_store_ref": "Invalid store reference.",
        "error.invalid_shelf_ref": "Invalid shelf reference for the selected store.",
        "error.invalid_product_ref": "Invalid product reference.",
        "error.invalid_coordinate": "{field} is invalid.",
        "flash.shelf_created": "Shelf created.",
        "flash.shelf_updated": "Shelf updated.",
        "flash.shelf_deleted": "Shelf deleted.",
        "flash.inventory_created": "Inventory item created.",
        "flash.inventory_updated": "Inventory item updated.",
        "flash.inventory_deleted": "Inventory item deleted.",
        "flash.store_created": "Store created.",
        "flash.store_updated": "Store updated.",
        "flash.store_deleted": "Store deleted.",
        "flash.product_created": "Product created.",
        "flash.product_updated": "Product updated.",
        "flash.product_deleted": "Product deleted.",
    },
}


def normalize_language(language: str | None) -> str | None:
    if language is None:
        return None
    language_code = language.strip().lower()
    if language_code in SUPPORTED_LANGUAGES:
        return language_code
    return None


def translate(language: str, key: str, **kwargs: str) -> str:
    catalog = TRANSLATIONS.get(language, TRANSLATIONS[DEFAULT_LANGUAGE])
    message = catalog.get(key, TRANSLATIONS[DEFAULT_LANGUAGE].get(key, key))
    if kwargs:
        return message.format(**kwargs)
    return message